# OpenClaw Tailscale Funnel - Deployment Reference

## This Deployment Details

**Date:** 2026-02-07  
**Server:** Ubuntu on AWS (ip-10-0-24-43)  
**Public IP:** 18.117.147.159  
**Tailscale IP:** 100.86.40.101  

## Instances

### Host Instance (Port 18789)

| Property | Value |
|----------|-------|
| Public URL | https://ip-10-0-24-43.tail9f77e8.ts.net/ |
| Password | openclawmanager |
| Token | 97bc45f6fb1d31be788c53bde8828a50fccefbd47b70da4d |
| Local Port | 18789 |

### Docker Instance (Port 18788)

| Property | Value |
|----------|-------|
| Public URL | https://ip-10-0-24-43.tail9f77e8.ts.net:10000/ |
| Password | dockerclaw2025 |
| Token | dockerclawtoken123 |
| Local Port | 18788 (mapped to container 18789) |

## API Key Configuration

### Host Instance

Auth profiles file: `~/.openclaw/agents/main/agent/auth-profiles.json`

```json
{
  "version": 1,
  "profiles": {
    "kimi-coding:default": {
      "type": "api_key",
      "provider": "kimi-coding",
      "key": "sk-kimi-JjUL1uVc92eVmo5fBXLfY4uT7hxUajCieDzIuGaEdeltgjzCzCtUO3pfbG81QGjN"
    }
  },
  "lastGood": {
    "kimi-coding": "kimi-coding:default"
  },
  "usageStats": {
    "kimi-coding:default": {
      "lastUsed": 1770472093726,
      "errorCount": 0
    }
  }
}
```

### Docker Instance

Auth profiles file: `/home/ubuntu/openclaw-docker-config/agents/main/agent/auth-profiles.json`

```json
{
  "version": 1,
  "profiles": {
    "kimi-coding:default": {
      "type": "api_key",
      "provider": "kimi-coding",
      "key": "sk-kimi-JjUL1uVc92eVmo5fBXLfY4uT7hxUajCieDzIuGaEdeltgjzCzCtUO3pfbG81QGjN"
    }
  },
  "lastGood": {
    "kimi-coding": "kimi-coding:default"
  },
  "usageStats": {
    "kimi-coding:default": {
      "lastUsed": 0,
      "errorCount": 0
    }
  }
}
```

**Required permissions:** `chmod 600 auth-profiles.json`

## Quick Commands

### Start Funnel (run this to enable public access)
```bash
# Host instance
sudo tailscale funnel --https=443 --set-path=/ http://127.0.0.1:18789

# Docker instance
sudo tailscale funnel --https=10000 --set-path=/ http://127.0.0.1:18788
```

### Check Status
```bash
# Tailscale status
tailscale status

# OpenClaw gateway status  
openclaw gateway status

# Pending pairings
openclaw devices list

# Docker container
sudo docker ps | grep openclaw-docker
```

### Restart Services

```bash
# Restart host gateway
openclaw gateway restart

# Restart Docker container
sudo docker restart openclaw-docker

# Re-run funnel (if stopped)
sudo tailscale funnel --https=443 --set-path=/ http://127.0.0.1:18789
```

## First-Time Access Steps

1. Open the Public URL
2. Enter password
3. If "pairing required" error:
   ```bash
   # Host
   openclaw devices list
   openclaw devices approve <id>
   
   # Docker
   sudo docker exec openclaw-docker node dist/index.js devices list
   sudo docker exec openclaw-docker node dist/index.js devices approve <id>
   ```
4. Refresh browser

## Config Locations

- **Host OpenClaw config:** `~/.openclaw/openclaw.json`
- **Host auth profiles:** `~/.openclaw/agents/main/agent/auth-profiles.json`
- **Docker config:** `/home/ubuntu/openclaw-docker-config/openclaw.json`
- **Docker auth profiles:** `/home/ubuntu/openclaw-docker-config/agents/main/agent/auth-profiles.json`
- **Host gateway logs:** `/tmp/openclaw/openclaw-2026-02-07.log`
- **Docker logs:** `sudo docker logs openclaw-docker`

## Security

- Password set in config
- Token auto-generated by OpenClaw or set via env var
- Funnel exposes to public internet
- API keys stored in auth-profiles.json (chmod 600)
- Consider Tailscale ACLs for IP restrictions
